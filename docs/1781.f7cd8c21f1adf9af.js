"use strict";(self.webpackChunkmppm=self.webpackChunkmppm||[]).push([[1781],{1781:(y,l,o)=>{o.r(l),o.d(l,{AddTrackPageModule:()=>M});var p=o(1048),s=o(9508),g=o(3957),a=o(1412),k=o(8239),h=o(9481),m=o(9077),n=o(257),v=o(1038),u=o(4863),f=o(8322);const C=["nameInput"];let T=(()=>{class d{constructor(e,t,i,r,O,_){this.activatedRoute=e,this.tracksService=t,this.nav=i,this.toastController=r,this.xlate=O,this.ytDownloadService=_,this.hidden=!0}ngOnInit(){if(this.trackIndex=Number(this.activatedRoute.snapshot.paramMap.get("index")),this.track={name:"",videoUrl:"",markers:[]},-1!==this.trackIndex){const e=this.tracksService.tracks[this.trackIndex];this.track.name=e.name,this.track.videoUrl=e.videoUrl}setTimeout(()=>this.hidden=!1,250)}ionViewWillEnter(){const e=(0,h.h)();e&&(this.track.videoUrl=e.id.videoId,this.track.name||(this.track.name=e.snippet.title),(0,h.F)(void 0)),setTimeout(()=>{var t,i;0===(null===(i=null===(t=this.track)||void 0===t?void 0:t.name)||void 0===i?void 0:i.length)&&this.ionInput.setFocus()},1e3)}addTrack(){let e=!1;if(this.file)this.tracksService.addFileTrack(this.file,this.track.name),e=!0;else{if(-1!==this.trackIndex){const t=this.tracksService.tracks[this.trackIndex];t.name=this.track.name,t.videoUrl=this.track.videoUrl}else e=!0,this.tracksService.tracks.push(Object.assign({},this.track));this.tracksService.saveTracks()}setTimeout(()=>{const t=this.nav.pop();e&&t.then(()=>this.nav.navigateRoot(["/home"],{animated:!1})).then(()=>this.nav.navigateForward(["/track",this.tracksService.tracks.length-1],{animated:!1}))})}ytSearch(){this.nav.navigateForward("/yt-search")}onFileChanged(e){this.file=e.target.files[0],this.track.name=this.file.name}ytDownload(e){var t=this;return(0,k.Z)(function*(){t.downloading||(t.downloading=!0,(yield t.ytDownloadService.initiateDownload((0,m.J)(e),t.track.name))||(yield t.toastController.create({message:t.xlate.transform("C_YT_DOWNLOAD_ERROR"),duration:4e3})).present(),t.downloading=!1)})()}}return d.\u0275fac=function(e){return new(e||d)(n.Y36(g.gz),n.Y36(v.X),n.Y36(a.SH),n.Y36(a.yF),n.Y36(u.j),n.Y36(f.Q))},d.\u0275cmp=n.Xpm({type:d,selectors:[["mppm-add-track"]],viewQuery:function(e,t){if(1&e&&n.Gf(C,5),2&e){let i;n.iGM(i=n.CRH())&&(t.ionInput=i.first)}},hostVars:2,hostBindings:function(e,t){2&e&&n.ekj("hidden",t.hidden)},decls:25,vars:22,consts:[["scroll-y","false"],[1,"add-track-content"],["clear-input","",3,"placeholder","ngModel","ngModelChange"],["nameInput",""],["name","search",3,"click"],["name","download",3,"click"],["type","indeterminate",1,"progress"],[1,"add",3,"disabled","click"],[1,"local-audio-file"],["type","file","accept","audio/*",3,"change"]],template:function(e,t){1&e&&(n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons"),n._UZ(3,"ion-back-button"),n.qZA(),n.TgZ(4,"ion-title"),n._uU(5),n.ALo(6,"xlate"),n.qZA()()(),n.TgZ(7,"ion-content",0)(8,"div",1)(9,"ion-input",2,3),n.NdJ("ngModelChange",function(r){return t.track.name=r}),n.ALo(11,"xlate"),n.qZA(),n.TgZ(12,"ion-input",2),n.NdJ("ngModelChange",function(r){return t.track.videoUrl=r}),n.ALo(13,"xlate"),n.qZA(),n.TgZ(14,"ion-icon",4),n.NdJ("click",function(){return t.ytSearch()}),n.qZA(),n.TgZ(15,"ion-icon",5),n.NdJ("click",function(){return t.ytDownload(t.track.videoUrl)}),n.qZA(),n._UZ(16,"ion-progress-bar",6),n.TgZ(17,"ion-button",7),n.NdJ("click",function(){return t.addTrack()}),n._uU(18),n.ALo(19,"xlate"),n.qZA(),n.TgZ(20,"div",8)(21,"label"),n._uU(22),n.ALo(23,"xlate"),n.qZA(),n.TgZ(24,"input",9),n.NdJ("change",function(r){return t.onFileChanged(r)}),n.qZA()()()()),2&e&&(n.xp6(5),n.Oqu(n.lcZ(6,12,t.trackIndex<0?"C_ADD_TRACK":"C_EDIT_TRACK")),n.xp6(4),n.Q6J("placeholder",n.lcZ(11,14,"C_NAME"))("ngModel",t.track.name),n.xp6(3),n.Q6J("placeholder",n.lcZ(13,16,"C_YT_OR_VIDEO_ID"))("ngModel",t.track.videoUrl),n.xp6(3),n.ekj("hidden",!t.track.videoUrl),n.xp6(1),n.ekj("hidden",!t.downloading),n.xp6(1),n.Q6J("disabled",!t.track.name||!t.track.videoUrl&&!t.file),n.xp6(1),n.hij(" ",n.lcZ(19,18,t.trackIndex<0?"C_ADD":"C_SAVE"),""),n.xp6(4),n.Oqu(n.lcZ(23,20,"C_LOCAL_AUDIO_FILE")))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.W2,a.pK,a.j9,s.JJ,s.On,a.gu,a.X7,a.YG],pipes:[u.j],styles:[".hidden[_nghost-%COMP%]{display:none}.add-track-content[_ngcontent-%COMP%]{padding:16px;display:grid;grid-template-columns:auto 35px}.add-track-content[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{grid-column:1}.add-track-content[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:nth-child(2){color:#aaa}.add-track-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{grid-column:2;justify-self:end;font-size:25pt;position:relative;top:-35px;cursor:pointer}.add-track-content[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{grid-column:2;justify-self:end;position:relative;top:-35px}.add-track-content[_ngcontent-%COMP%]   .progress.hidden[_ngcontent-%COMP%]{visibility:hidden}.add-track-content[_ngcontent-%COMP%]   ion-icon[name=search][_ngcontent-%COMP%]{color:#aaa}.add-track-content[_ngcontent-%COMP%]   ion-icon[name=download][_ngcontent-%COMP%]{position:relative;top:-37px;color:var(--ion-color-primary);cursor:pointer}.add-track-content[_ngcontent-%COMP%]   ion-icon[name=download].hidden[_ngcontent-%COMP%]{visibility:hidden}.add-track-content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{grid-column:1/3}.add[_ngcontent-%COMP%]{margin-top:20px}.local-audio-file[_ngcontent-%COMP%]{margin-top:35px;overflow:hidden}.local-audio-file[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:18px;display:block;padding-bottom:4px}"]}),d})();var P=o(9174);const A=[{path:"",component:T}];let M=(()=>{class d{}return d.\u0275fac=function(e){return new(e||d)},d.\u0275mod=n.oAB({type:d}),d.\u0275inj=n.cJS({imports:[[p.ez,P.q,s.u5,a.Pc,g.Bz.forChild(A)]]}),d})()}}]);