(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"J9w/":function(l,n,e){"use strict";e.r(n);var t=e("8Y7J"),u=e("mrSG"),r=e("OZIg"),i=e("SSuX"),o=e("ZZ/e"),a=e("DHcw"),s=e("jGYT"),c=e("3dv3");const p=200,m=5;class k{constructor(l,n,e,t,u,r,i){this.activatedRoute=l,this.tracksService=n,this.playerService=e,this.actionSheetController=t,this.nav=u,this.xlate=r,this.markerPipe=i,this.showHelp=!1}ngOnInit(){this.trackIndex=Number(this.activatedRoute.snapshot.paramMap.get("index")),this.track=this.tracksService.tracks[this.trackIndex],this.subscription=this.playerService.playerReady.subscribe(()=>{this.track.file?this.playerService.openFile(this.track.file,this.audio.nativeElement):this.playerService.open(this.track.videoUrl,this.ytplayer,this.header.nativeElement.offsetWidth)}),this.subscription.add(s.a.marker.subscribe(l=>{switch(l.action){case s.b.ADD:this.addMarker();break;case s.b.MOVE_ACTIVE:this.moveMarker(l.data);break;case s.b.SET_ACTIVE:this.setActiveMarker(l.data);break;case s.b.SEEK_TO_ACTIVE:this.seekToActiveMarker();break;case s.b.TOGGLE_HELP:this.showHelp=!this.showHelp}})),this.playPositionTimer=setInterval(()=>{(this.playPosition||this.playerService.isPlaying)&&(this.playPosition=this.markerPipe.transform(this.playerService.getCurrentTime()))},500)}ngOnDestroy(){this.subscription.unsubscribe(),this.playerService.destroy(),clearInterval(this.playPositionTimer)}get playPauseIcon(){return this.playerService.isPlaying?"pause":"play"}get markers(){return this.track.markers}playPause(){this.playerService.playPause()}seekToStart(){this.playerService.seekToStart()}backwardForward(l,n=1){this.playerService.backwardForward(l,n)}backwardForwardLong(l){this.longClickInterval=setInterval(()=>this.backwardForward(l,m),p)}longClickEnd(){clearInterval(this.longClickInterval)}moveMarkerLong(l){this.longClickInterval=setInterval(()=>this.moveMarker(l,m),p)}seekToActiveMarker(){this.playerService.seekTo(this.track.markers[this.activeMarker].value,!0)}get noActiveMarker(){return void 0===this.activeMarker}get isAtStart(){return 0===this.playerService.getCurrentTime()}addMarker(){const l=this.playerService.getCurrentTime();l&&(this.track.markers.push({value:l}),this.sortMarkers(),this.activeMarker=this.track.markers.findIndex(n=>n.value===l),this.tracksService.saveTracks())}deleteMarker(l){this.track.markers=this.track.markers.filter((n,e)=>e!==l),delete this.activeMarker,this.tracksService.saveTracks()}setActiveMarker(l){l>=0&&l<this.track.markers.length&&(this.activeMarker=l,this.seekToActiveMarker())}moveMarker(l,n=1){const{activeMarker:e,track:t}=this,{markers:u}=t,r=Object(i.b)(u[e].value,l,n);u[e].value=r,this.sortMarkers(),this.activeMarker=u.findIndex(l=>l.value===r),this.seekToActiveMarker(),this.tracksService.saveTracks()}sortMarkers(){this.track.markers.sort((l,n)=>l.value<n.value?-1:l.value>n.value?1:0)}presentActionSheet(l){return u.a(this,void 0,void 0,function*(){const n=yield this.actionSheetController.create({header:`${this.xlate.transform("C_MARKER")} ${this.track.markers[l].title||""}`,buttons:[{text:this.xlate.transform("C_DESCRIPTION"),icon:"create",handler:()=>this.nav.navigateForward(["/marker-detail",this.trackIndex,l])},{text:this.xlate.transform("C_DELETE"),icon:"trash",handler:()=>this.deleteMarker(l)}]});yield n.present()})}}class b{}var d=e("pMnS"),h=e("oBZk");class g{constructor(){this.mppmClick=new t.m,this.mppmClickLong=new t.m,this.mppmClickEnd=new t.m}touchstart(){return this.event(!0)}touchend(){return this.event(!1)}mousedown(){return this.event(!0)}mouseup(){return this.event(!1)}event(l){return l?(this.hadLong=!1,this.longPressTimer=setTimeout(()=>{this.hadLong=!0,this.mppmClickLong.next()},500)):(clearTimeout(this.longPressTimer),this.hadLong||this.mppmClick.next(),this.mppmClickEnd.next()),!1}}var v=e("SVse"),C=e("iInd"),x=t.ob({encapsulation:0,styles:[[".header[_ngcontent-%COMP%]{padding:7px 7px 3px;background-color:#fff;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.tools[_ngcontent-%COMP%]{height:40%;display:grid;grid-row-gap:3px;margin:0 2px 2px}.tools[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{height:100%}.play-pause[_ngcontent-%COMP%]{grid-column:1/4;text-align:center}.backward[_ngcontent-%COMP%], .forward[_ngcontent-%COMP%], .seek-to-start[_ngcontent-%COMP%]{grid-row:2}.marker-tools[_ngcontent-%COMP%]{grid-row:3;grid-column:1/4;display:flex;padding-top:1px}.marker-tools[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:100%;flex:1}.marker-active[_ngcontent-%COMP%]{--background:green}.markers[_ngcontent-%COMP%]{margin:2px}.markers[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;margin:2px}.marker-title[_ngcontent-%COMP%]{font-size:9pt;position:absolute;left:2px;bottom:2px;text-transform:initial}.main-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.spacer[_ngcontent-%COMP%]{flex:1}ion-button[_ngcontent-%COMP%]{font-size:14pt;margin:2px}.key[_ngcontent-%COMP%]{color:wheat;font-size:10pt;right:5px;top:5px;position:absolute;text-transform:initial;visibility:hidden}.show-help[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{visibility:visible}.play-position[_ngcontent-%COMP%]{font-size:12pt;position:absolute;bottom:5px;left:10px}audio[_ngcontent-%COMP%]{margin-bottom:80px;width:100%;padding:5px}"]],data:{}});function w(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,8,"ion-button",[["mppmLongClick",""]],[[2,"marker-active",null]],[[null,"mppmClickLong"],[null,"mppmClick"],[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(l,n,e){var u=!0,r=l.component;return"touchstart"===n&&(u=!1!==t.Bb(l,1).touchstart()&&u),"touchend"===n&&(u=!1!==t.Bb(l,1).touchend()&&u),"mousedown"===n&&(u=!1!==t.Bb(l,1).mousedown()&&u),"mouseup"===n&&(u=!1!==t.Bb(l,1).mouseup()&&u),"mppmClickLong"===n&&(u=!1!==r.presentActionSheet(l.context.index)&&u),"mppmClick"===n&&(u=!1!==r.setActiveMarker(l.context.index)&&u),u},h.s,h.b)),t.pb(1,16384,null,0,g,[],null,{mppmClick:"mppmClick",mppmClickLong:"mppmClickLong"}),t.pb(2,49152,null,0,o.j,[t.h,t.k,t.x],{color:[0,"color"]},null),(l()(),t.Hb(3,0,[" "," "])),t.Db(4,1),(l()(),t.qb(5,0,null,0,1,"span",[["class","marker-title"]],null,null,null,null,null)),(l()(),t.Hb(6,null,["",""])),(l()(),t.qb(7,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(8,null,["",""]))],function(l,n){l(n,2,0,n.component.activeMarker===n.context.index?void 0:"success")},function(l,n){l(n,0,0,n.component.activeMarker===n.context.index);var e=t.Ib(n,3,0,l(n,4,0,t.Bb(n.parent,0),n.context.$implicit.value));l(n,3,0,e),l(n,6,0,n.context.$implicit.title),l(n,8,0,n.context.index+1)})}function f(l){return t.Jb(0,[t.Cb(0,c.a,[]),t.Fb(402653184,1,{ytplayer:0}),t.Fb(402653184,2,{audio:0}),t.Fb(402653184,3,{header:0}),(l()(),t.qb(4,0,[[3,0],["header",1]],null,1,"div",[["class","header"]],null,null,null,null,null)),(l()(),t.Hb(5,null,["",""])),(l()(),t.qb(6,0,null,null,64,"ion-content",[],[[2,"show-help",null]],null,null,h.t,h.c)),t.pb(7,49152,null,0,o.t,[t.h,t.k,t.x],null,null),(l()(),t.qb(8,0,null,0,62,"div",[["class","main-content"]],null,null,null,null,null)),(l()(),t.qb(9,0,null,null,55,"div",[["class","tools"]],null,null,null,null,null)),(l()(),t.qb(10,0,null,null,7,"ion-button",[["class","play-pause"]],null,[[null,"click"]],function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.playPause()&&t),t},h.s,h.b)),t.pb(11,49152,null,0,o.j,[t.h,t.k,t.x],null,null),(l()(),t.qb(12,0,null,0,1,"ion-icon",[],null,null,null,h.x,h.g)),t.pb(13,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(14,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["space"])),(l()(),t.qb(16,0,null,0,1,"div",[["class","play-position"]],null,null,null,null,null)),(l()(),t.Hb(17,null,["",""])),(l()(),t.qb(18,0,null,null,5,"ion-button",[["class","seek-to-start"]],null,[[null,"click"]],function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.seekToStart()&&t),t},h.s,h.b)),t.pb(19,49152,null,0,o.j,[t.h,t.k,t.x],null,null),(l()(),t.qb(20,0,null,0,1,"ion-icon",[["name","skip-backward"]],null,null,null,h.x,h.g)),t.pb(21,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(22,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["return"])),(l()(),t.qb(24,0,null,null,6,"ion-button",[["class","backward"],["mppmLongClick",""]],null,[[null,"mppmClick"],[null,"mppmClickLong"],[null,"mppmClickEnd"],[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(l,n,e){var u=!0,r=l.component;return"touchstart"===n&&(u=!1!==t.Bb(l,25).touchstart()&&u),"touchend"===n&&(u=!1!==t.Bb(l,25).touchend()&&u),"mousedown"===n&&(u=!1!==t.Bb(l,25).mousedown()&&u),"mouseup"===n&&(u=!1!==t.Bb(l,25).mouseup()&&u),"mppmClick"===n&&(u=!1!==r.backwardForward(!0)&&u),"mppmClickLong"===n&&(u=!1!==r.backwardForwardLong(!0)&&u),"mppmClickEnd"===n&&(u=!1!==r.longClickEnd()&&u),u},h.s,h.b)),t.pb(25,16384,null,0,g,[],null,{mppmClick:"mppmClick",mppmClickLong:"mppmClickLong",mppmClickEnd:"mppmClickEnd"}),t.pb(26,49152,null,0,o.j,[t.h,t.k,t.x],null,null),(l()(),t.qb(27,0,null,0,1,"ion-icon",[["name","rewind"]],null,null,null,h.x,h.g)),t.pb(28,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(29,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["left"])),(l()(),t.qb(31,0,null,null,6,"ion-button",[["class","forward"],["mppmLongClick",""]],null,[[null,"mppmClick"],[null,"mppmClickLong"],[null,"mppmClickEnd"],[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(l,n,e){var u=!0,r=l.component;return"touchstart"===n&&(u=!1!==t.Bb(l,32).touchstart()&&u),"touchend"===n&&(u=!1!==t.Bb(l,32).touchend()&&u),"mousedown"===n&&(u=!1!==t.Bb(l,32).mousedown()&&u),"mouseup"===n&&(u=!1!==t.Bb(l,32).mouseup()&&u),"mppmClick"===n&&(u=!1!==r.backwardForward(!1)&&u),"mppmClickLong"===n&&(u=!1!==r.backwardForwardLong(!1)&&u),"mppmClickEnd"===n&&(u=!1!==r.longClickEnd()&&u),u},h.s,h.b)),t.pb(32,16384,null,0,g,[],null,{mppmClick:"mppmClick",mppmClickLong:"mppmClickLong",mppmClickEnd:"mppmClickEnd"}),t.pb(33,49152,null,0,o.j,[t.h,t.k,t.x],null,null),(l()(),t.qb(34,0,null,0,1,"ion-icon",[["name","fastforward"]],null,null,null,h.x,h.g)),t.pb(35,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(36,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["right"])),(l()(),t.qb(38,0,null,null,26,"div",[["class","marker-tools"]],null,null,null,null,null)),(l()(),t.qb(39,0,null,null,5,"ion-button",[["color","success"]],null,[[null,"click"]],function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.seekToActiveMarker()&&t),t},h.s,h.b)),t.pb(40,49152,null,0,o.j,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"]},null),(l()(),t.qb(41,0,null,0,1,"ion-icon",[["name","skip-backward"]],null,null,null,h.x,h.g)),t.pb(42,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(43,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["backspace"])),(l()(),t.qb(45,0,null,null,6,"ion-button",[["color","success"],["mppmLongClick",""]],null,[[null,"mppmClick"],[null,"mppmClickLong"],[null,"mppmClickEnd"],[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(l,n,e){var u=!0,r=l.component;return"touchstart"===n&&(u=!1!==t.Bb(l,46).touchstart()&&u),"touchend"===n&&(u=!1!==t.Bb(l,46).touchend()&&u),"mousedown"===n&&(u=!1!==t.Bb(l,46).mousedown()&&u),"mouseup"===n&&(u=!1!==t.Bb(l,46).mouseup()&&u),"mppmClick"===n&&(u=!1!==r.moveMarker(!0)&&u),"mppmClickLong"===n&&(u=!1!==r.moveMarkerLong(!0)&&u),"mppmClickEnd"===n&&(u=!1!==r.longClickEnd()&&u),u},h.s,h.b)),t.pb(46,16384,null,0,g,[],null,{mppmClick:"mppmClick",mppmClickLong:"mppmClickLong",mppmClickEnd:"mppmClickEnd"}),t.pb(47,49152,null,0,o.j,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"]},null),(l()(),t.qb(48,0,null,0,1,"ion-icon",[["name","rewind"]],null,null,null,h.x,h.g)),t.pb(49,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(50,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["up"])),(l()(),t.qb(52,0,null,null,6,"ion-button",[["color","success"],["mppmLongClick",""]],null,[[null,"mppmClick"],[null,"mppmClickLong"],[null,"mppmClickEnd"],[null,"touchstart"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"]],function(l,n,e){var u=!0,r=l.component;return"touchstart"===n&&(u=!1!==t.Bb(l,53).touchstart()&&u),"touchend"===n&&(u=!1!==t.Bb(l,53).touchend()&&u),"mousedown"===n&&(u=!1!==t.Bb(l,53).mousedown()&&u),"mouseup"===n&&(u=!1!==t.Bb(l,53).mouseup()&&u),"mppmClick"===n&&(u=!1!==r.moveMarker(!1)&&u),"mppmClickLong"===n&&(u=!1!==r.moveMarkerLong(!1)&&u),"mppmClickEnd"===n&&(u=!1!==r.longClickEnd()&&u),u},h.s,h.b)),t.pb(53,16384,null,0,g,[],null,{mppmClick:"mppmClick",mppmClickLong:"mppmClickLong",mppmClickEnd:"mppmClickEnd"}),t.pb(54,49152,null,0,o.j,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"]},null),(l()(),t.qb(55,0,null,0,1,"ion-icon",[["name","fastforward"]],null,null,null,h.x,h.g)),t.pb(56,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(57,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["down"])),(l()(),t.qb(59,0,null,null,5,"ion-button",[["color","success"]],null,[[null,"click"]],function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.addMarker()&&t),t},h.s,h.b)),t.pb(60,49152,null,0,o.j,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"]},null),(l()(),t.qb(61,0,null,0,1,"ion-icon",[["name","add"]],null,null,null,h.x,h.g)),t.pb(62,49152,null,0,o.B,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(63,0,null,0,1,"span",[["class","key"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["a"])),(l()(),t.qb(65,0,null,null,2,"div",[["class","markers"]],null,null,null,null,null)),(l()(),t.fb(16777216,null,null,1,null,w)),t.pb(67,278528,null,0,v.h,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null),(l()(),t.qb(68,0,null,null,0,"div",[["class","spacer"]],null,null,null,null,null)),(l()(),t.qb(69,0,[[2,0],["audio",1]],null,0,"audio",[["controls",""]],[[8,"hidden",0]],null,null,null,null)),(l()(),t.qb(70,0,[[1,0],["ytplayer",1]],null,0,"div",[],[[8,"hidden",0]],null,null,null,null))],function(l,n){var e=n.component;l(n,13,0,e.playPauseIcon),l(n,21,0,"skip-backward"),l(n,28,0,"rewind"),l(n,35,0,"fastforward"),l(n,40,0,"success",e.noActiveMarker),l(n,42,0,"skip-backward"),l(n,47,0,"success",e.noActiveMarker),l(n,49,0,"rewind"),l(n,54,0,"success",e.noActiveMarker),l(n,56,0,"fastforward"),l(n,60,0,"success",e.isAtStart),l(n,62,0,"add"),l(n,67,0,e.markers)},function(l,n){var e=n.component;l(n,5,0,null==e.track?null:e.track.name),l(n,6,0,e.showHelp),l(n,17,0,e.playPosition),l(n,69,0,!e.track.isFile),l(n,70,0,e.track.isFile)})}function M(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,1,"app-track",[],null,null,null,f,x)),t.pb(1,245760,null,0,k,[C.a,r.a,i.a,o.a,o.Fb,a.a,c.a],null,null)],function(l,n){l(n,1,0)},null)}var y=t.mb("app-track",k,M,{},{},[]),P=e("s7LF"),E=e("a6Df");e.d(n,"TrackPageModuleNgFactory",function(){return L});var L=t.nb(b,[],function(l){return t.yb([t.zb(512,t.j,t.Y,[[8,[d.a,y]],[3,t.j],t.v]),t.zb(4608,v.k,v.j,[t.s,[2,v.q]]),t.zb(4608,P.g,P.g,[]),t.zb(4608,o.c,o.c,[t.x,t.g]),t.zb(4608,o.Eb,o.Eb,[o.c,t.j,t.p]),t.zb(4608,o.Hb,o.Hb,[o.c,t.j,t.p]),t.zb(1073742336,v.b,v.b,[]),t.zb(1073742336,E.a,E.a,[]),t.zb(1073742336,P.f,P.f,[]),t.zb(1073742336,P.a,P.a,[]),t.zb(1073742336,o.Cb,o.Cb,[]),t.zb(1073742336,C.n,C.n,[[2,C.s],[2,C.m]]),t.zb(1073742336,b,b,[]),t.zb(1024,C.k,function(){return[[{path:"",component:k}]]},[])])})}}]);